server {
    listen 80;
    server_name j12e203.p.ssafy.io;  # 또는 와일드카드 "_"로 모든 도메인을 처리

    # 프론트엔드: 기본 요청은 프론트엔드 컨테이너(5173)로 전달
    location / {
        proxy_pass http://frontend_container:5173;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # 백엔드 API: "/api/" 하위 경로의 요청은 백엔드 컨테이너(8081)로 전달
    location /api/ {
        proxy_pass http://backend_container:8081/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # 추천 서비스: "/recommend/" 하위 경로의 요청은 추천 컨테이너(8000)로 전달
    location /recommend/ {
        proxy_pass http://recommend_container:8000/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}